<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.1.1/tailwind.min.css"
        integrity="sha512-BAK6UB671tmfzrkeH1CacTvgHQ3aLAFnT2KsigdATsc5X7+3u42tb5vjmAoDiqtxphP5dNZ3cDygivTsGEJhGw=="
        crossorigin="anonymous" />
    <script src='https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.1/css/font-awesome.min.css" />
    <link rel="stylesheet" href="../static/style.css">
    </style>
    <style>
        #hiddenAllDataPhongKhach {
            display: none;
        }

        #hiddenPhongKhach {
            display: none;
        }

        #offautoDaikin {
            display: none;
        }

        #scrolltopbtn {
            display: none;
            position: fixed;
            bottom: 65px;
        }
    </style>
</head>

<body class="bg-gray-200">

    <!-- API 7forest weather -->
    <a class="weatherwidget-io" href="https://forecast7.com/en/10d82106d63/ho-chi-minh-city/" data-label_1="HO CHI MINH"
        data-label_2="WEATHER" data-font="Consolas" data-icons="Climacons Animated" data-theme="hexellence"
        data-textcolor="#460af2" data-highcolor="#ff0404" data-lowcolor="#008a63" data-cloudcolor="#49539d"
        data-cloudfill="#a1def6" data-raincolor="#071272">HO CHI MINH WEATHER</a>
    <script>
        !function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = 'https://weatherwidget.io/js/widget.min.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'weatherwidget-io-js');
    </script>

    <!-- NAV BAR -->
    <nav>
        <div class="flex flex-wrap">
            <div class="w-full md:w-1/4 bg-gray-700 text-center text-white font-bold text-2xl p-2">IoT Smart Home
            </div>
            <div class="w-full md:w-3/4 bg-gray-500 text-center text-gray-200"
                style="font-family: 'Brush Script MT', cursive;">
                <ul class="flex flex-wrap">
                    <li class="w-1/2 bg-gray-400 hover:bg-blue-500 text-2xl text-white hover:text-red-400 p-2">
                        <a href="{{ url_for('index') }}" class="">
                            Danh sách phòng
                        </a>
                    </li>
                    <li class="w-1/2 bg-gray-500 hover:bg-blue-500 text-2xl text-white hover:text-red-400 p-2">
                        <a href="{{ url_for('camera') }}" class="">
                            Camera
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div>
        <div onclick="topFunction()" id="scrolltopbtn"
            class="border-2 border-black rounded-full p-2 flex items-center justify-center bg-white font-bold text-xl right-2 hover:bg-black hover:text-white">
            Top</div>
    </div>
    <div>
        <input type="text" id="voiceresult">
        <button type="button" class="border-2 p-3" onclick="startVoiceControl()"><i class="fa fa-microphone"></i> start</button>
        <button type="button" class="border-2 p-3" onclick="stopVoiceControl()"><i class="fa fa-remove"></i> stop</button>
    </div>
    <!-- table ROOM-->
    <div class="flex flex-wrap">
        <!-- danh sách phòng -->
        <div class="w-full md:w-1/4">
            <br>
            <div class="grid grid-cols-2 gap-2 text-2xl text-center font-bold mx-2"
                style="font-family: Arial, Helvetica, sans-serif">
                <div class="text-blue-700">
                    Phòng Khách
                    <a href="#hiddenPhongKhach" onclick="showPhongKhach()"><img src="../static/home.jpg" alt=""
                            class="border-4 border-gray-400" id="phongkhach"></a>
                </div>
                <div class="text-red-700">
                    Phòng Ngủ
                    <a href="#"><img src="../static/home.jpg" alt="" class="border-4 border-gray-400"></a>
                </div>
                <div class="text-green-700">
                    Nhà Bếp
                    <a href="#"><img src="../static/home.jpg" alt="" class="border-4 border-gray-400"></a>
                </div>
                <div class="text-pink-400">
                    Nhà Vệ Sinh
                    <a href="#"><img src="../static/home.jpg" alt="" class="border-4 border-gray-400"></a>
                </div>
            </div>
            <br>
            <br>
        </div>
        <div class="w-full md:w-3/4">
            <div class="flex flex-wrap mx-2">
                <div class="md:w-1/2">
                    <hr>
                    <div id="hiddenPhongKhach">
                        <div>
                            <div
                                class="xl:text-3xl lg:text-3xl md:text-2xl sm:text-xl xs:text-xl ml-5 text-gray-700 font-semibold">
                                <div id="apiOpenWeather"></div>
                            </div>
                            <div class="text-right"><a href="#hiddenAllDataPhongKhach" onclick="showAllThongTinPK()"
                                    id="showAllThongTinPK"
                                    class="hover:text-green-300 text-blue-700 font-extrabold">View more..></a></div>
                            <hr>
                            <table class="relative w-full border table-fixed">
                                <tr>
                                    <thead class="text-pink-500 text-2xl">
                                        <th>Time
                                        </th>
                                        <th>Humi(%)</th>
                                        <th>Temp(°C)</th>
                                    </thead>
                                    <tbody class="font-bold text-center">
                                        <td id="DatePK"
                                            class="xl:text-3xl lg:text-3xl md:text-2xl sm:text-xl xs:text-xl text-gray-500">
                                        </td>
                                        <td id="HumiPK"
                                            class="xl:text-6xl lg:text-5xl md:text-4xl sm:text-3xl xs:text-3xl text-blue-500">
                                        </td>
                                        <td id="TempPK"
                                            class="xl:text-6xl lg:text-5xl md:text-4xl sm:text-3xl xs:text-3xl text-red-500">
                                        </td>
                                    </tbody>
                                </tr>
                            </table>
                            <br>
                            <div
                                class="grid grid-cols-3 text-center xl:text-3xl lg:text-3xl md:text-2xl sm:text-2xl xs:text-xl font-extrabold">
                                <div></div>
                                <div class="text-green-500">Min</div>
                                <div class="text-yellow-500">Max</div>
                                <div class="text-blue-500">Temp</div>
                                <div id="tempMin" class="text-blue-400"></div>
                                <div id="tempMax" class="text-blue-700"></div>
                                <div class="text-red-500">Humidity</div>
                                <div id="humiMin" class="text-red-400"></div>
                                <div id="humiMax" class="text-red-700"></div>
                            </div>
                            <br>
                            <div class="flex flex-wrap text-center">
                                <div class="w-full md:w-1/2 text-gray-700 font-medium xl:text-2xl">Turn On/Off LED</div>
                                <div class="w-full md:w-1/2">
                                    <!-- Toggle LED -->
                                    <div class="flex items-center justify-center w-full">
                                        <label for="toggleLED" class="flex items-center cursor-pointer">
                                            <div class="text-gray-700 font-medium mr-3">
                                                OFF
                                            </div>
                                            <!-- toggle -->
                                            <div class="relative">
                                                <!-- input -->
                                                <input type="checkbox" name="toggleLED" id="toggleLED" class="sr-only">
                                                <!-- line -->
                                                <div class="block bg-gray-300 w-14 h-8 rounded-full"></div>
                                                <!-- dot -->
                                                <div
                                                    class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition">
                                                </div>
                                            </div>
                                            <div class="ml-3 text-gray-700 font-medium">
                                                ON
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <div class="flex flex-wrap text-center">
                                <div class="w-full md:w-1/2 text-gray-700 font-medium xl:text-2xl">Auto Control DaiKinAC
                                </div>
                                <div class="w-full md:w-1/2">
                                    <!-- Toggle DaikinAC -->
                                    <div class="flex items-center justify-center w-full">
                                        <label for="toggleAutoDaikinAC" class="flex items-center cursor-pointer">
                                            <div class="text-gray-700 font-medium mr-3">
                                                OFF
                                            </div>
                                            <!-- toggle -->
                                            <div class="relative">
                                                <!-- input -->
                                                <input type="checkbox" id="toggleAutoDaikinAC" class="sr-only">
                                                <!-- line -->
                                                <div class="block bg-gray-300 w-14 h-8 rounded-full"></div>
                                                <!-- dot -->
                                                <div
                                                    class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition">
                                                </div>
                                            </div>
                                            <div class="ml-3 text-gray-700 font-medium">
                                                ON
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <br>
                            <hr>
                            <div id="offautoDaikin">
                                <div class="flex flex-wrap w-full">
                                    <div class="md:w-1/2 w-full">
                                        <div class="flex flex-wrap">
                                            <div class="w-1/2 text-center">
                                                <div>Turn On-Off</div>
                                                <div class="flex items-center justify-center w-full mt-2">

                                                    <label for="toggleDaikinAC"
                                                        class="flex items-center cursor-pointer">
                                                        <!-- toggle -->
                                                        <div class="relative">
                                                            <!-- input -->
                                                            <input type="checkbox" id="toggleDaikinAC" class="sr-only">
                                                            <!-- line -->
                                                            <div class="block bg-gray-300 w-14 h-8 rounded-full"></div>
                                                            <!-- dot -->
                                                            <div
                                                                class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition">
                                                            </div>
                                                        </div>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="w-1/2 text-center">
                                                <div class="custom-number-input">
                                                    <label for="custom-input-number"
                                                        class="text-gray-700 text-sm font-semibold">
                                                        Down - Up
                                                    </label>
                                                    <div class="text-center mx-2">
                                                        <div
                                                            class="flex flex-row h-10 rounded-lg relative bg-transparent mt-1">
                                                            <button data-action="decrement" id="decrement"
                                                                class=" bg-gray-300 text-gray-600 hover:text-gray-700 hover:bg-gray-400 h-full w-20 rounded-l cursor-pointer outline-none">
                                                                <span class="m-auto text-2xl font-bold">−</span>
                                                            </button>

                                                            <label id="nhietdoDaikin"
                                                                class="outline-none focus:outline-none text-3xl bg-gray-300 font-semibold text-md md:text-basecursor-default flex items-center text-gray-700  outline-none px-2">
                                                            </label>
                                                            <button data-action="increment" id="increment"
                                                                class="bg-gray-300 text-gray-600 hover:text-gray-700 hover:bg-gray-400 h-full w-20 rounded-r cursor-pointer">
                                                                <span class="m-auto text-2xl font-bold">+</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <br>
                                    <br>
                                    <br>
                                    <div class="md:w-1/2 w-full">
                                        <div class="flex flex-wrap">
                                            <div class="w-1/2 md:w-1/2 text-center">
                                                <div>Fan</div>
                                                <div>
                                                    <button class="" value="min" id="valuebtnFan1"
                                                        onclick="getvalueFanDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/fanlow.png" alt=""
                                                            id="imgFan1"></img></button>
                                                    <button class="" value="med" id="valuebtnFan2"
                                                        onclick="getvalueFanDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/fanmed.png" alt=""
                                                            id="imgFan2"></img></button>
                                                    <button class="" value="max" id="valuebtnFan3"
                                                        onclick="getvalueFanDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/fanmax.png" alt=""
                                                            id="imgFan3"></img></button>
                                                </div>
                                            </div>
                                            <div class="w-1/2 md:w-1/2 text-center">
                                                <div>Mode</div>
                                                <div>
                                                    <button class="" value="auto" id="valuebtnMode1"
                                                        onclick="getvalueModeDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/auto.png" alt=""
                                                            id="imgMode1"></img></button>
                                                    <button class="" value="snow" id="valuebtnMode2"
                                                        onclick="getvalueModeDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/snow.png" alt=""
                                                            id="imgMode2"></img></button>
                                                    <button class="" value="dry" id="valuebtnMode3"
                                                        onclick="getvalueModeDaikin()"><img
                                                            class="border-2 border-red-200" src="../static/icon/dry.png"
                                                            alt="" id="imgMode3"></button>
                                                    <button class="" value="fan" id="valuebtnMode4"
                                                        onclick="getvalueModeDaikin()"><img
                                                            class="border-2 border-red-200" src="../static/icon/fan.png"
                                                            alt="" id="imgMode4"></button>
                                                    <button class="" value="heat" id="valuebtnMode5"
                                                        onclick="getvalueModeDaikin()"><img
                                                            class="border-2 border-red-200"
                                                            src="../static/icon/heat.png" alt="" id="imgMode5"></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <br>
                                    <br>
                                    <br>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <br>
                </div>
                <div class="md:w-1/2 w-full">
                    <div class="mx-2">
                        <!-- video live -->
                        <div class="text-center hidden">
                            <img src="{{ url_for('video_feed') }}" class="mx-auto">
                        </div>
                        <div id="hiddenAllDataPhongKhach">
                            <div class="text-2xl text-center">Thống kê dữ liệu phòng khách</div>
                            <table class="text-center w-full">
                                <thead class="bg-gray-700 flex text-white w-full">
                                    <tr class="m-2 w-full flex">
                                        <th class="p-1 w-full md:w-1/5">Time</th>
                                        <th class="p-1 w-full md:w-1/5">Temp</th>
                                        <th class="p-1 w-full md:w-1/5">Humi</th>
                                        <th class="p-1 w-full md:w-1/5">Light</th>
                                        <th class="p-1 w-full md:w-1/5">Motion</th>
                                        <!-- <th class="p-2 w-1/6">Status Daikin</th> -->
                                    </tr>
                                </thead>
                                <tbody id="tbodythongke"
                                    class="bg-grey-light flex flex-col items-center justify-between overflow-y-scroll w-full"
                                    style="height: 30vh;">

                                </tbody>
                            </table>
                            <div class="chart-container" style="height: 400px;">
                                <canvas id="myChart"></canvas>
                                <br>
                                <br>
                                <br>
                                <br>
                                <br>
                                <br>
                                <br>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer text-center bg-gray-400 text-white font-semibold text-xl">
        <p class="mt-15">Nguyễn Cao Anh Minh - Nguyễn Thị Hậu</p>
    </div>
</body>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-app.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.2/firebase-analytics.js"></script>
<script id="MainScript" src="../static/app.js"></script>
<script type="text/javascript">
    // Nhận dạng giọng nói
    var voicecontrol = document.getElementById('voiceresult');
    var speechRecognizer = new webkitSpeechRecognition();
    var firebaseRef = firebase.database().ref('PKThietBiDieuKhien')
    function startVoiceControl() {
        if ('webkitSpeechRecognition' in window) {
            speechRecognizer.continuous = true; //tiếp tục đợi để nghe
            speechRecognizer.interimResults = true; //kết quả tạm thời đoán trước(gợi ý từ)
            speechRecognizer.start();
            var finalTranscripts = '';
            speechRecognizer.onresult = function (event) {
                var interimTranscripts = '';
                for (var i = event.resultIndex; i < event.results.length; i++) {
                    var transcript = event.results[i][0].transcript;
                    transcript.replace("\n", "<br>");
                    if (event.results[i].isFinal) {
                        finalTranscripts += transcript;
                        //console.log("final: " + finalTranscripts)
                    } else {
                        interimTranscripts += transcript;
                        //console.log("inter: " + interimTranscripts)
                    }
                }
                //Kết quả thu được voicecontrol.value
                voicecontrol.value = finalTranscripts + interimTranscripts;
                var a = voicecontrol.value
                console.log("voice control: " + voicecontrol.value)
                if (a.toLowerCase() == "bật đèn") {
                    firebaseRef.update({
                        "LedStatus": "ON"
                    })
                }
                else if (a.toLowerCase() == "tắt đèn") {
                    firebaseRef.update({
                        "LedStatus": "OFF"
                    })
                }
            };
            speechRecognizer.onerror = function (event) {
            };
        } else {
            voicecontrol.innerHTML = 'No browser support. Please upgrade your browser';
        }
    }
    function stopVoiceControl() {
        speechRecognizer.stop();
    }
</script>

</html>